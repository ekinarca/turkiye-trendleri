---
import type { CollectionEntry } from 'astro:content';
import { formatDate, formatRelativeTime } from '../utils/date';
import { isArchived } from '../utils/archive';

interface Props {
  post: CollectionEntry<'posts'>;
  showArchiveBadge?: boolean;
}

const { post, showArchiveBadge = true } = Astro.props;
const { title, summary, category, publishedAt, readingTime, sources } = post.data;
const archived = isArchived(publishedAt);
---

<article class="article-card">
  <a href={`/haber/${post.slug}`}>
    <div class="card-header">
      <span class="category" data-category={category}>{category}</span>
      {showArchiveBadge && archived && (
        <span class="archive-badge">ðŸ“… ArÅŸiv</span>
      )}
    </div>
    <h3>{title}</h3>
    <p class="summary">{summary}</p>
    <div class="meta">
      <time datetime={publishedAt}>{formatDate(publishedAt)}</time>
      <span>Â·</span>
      <span>{readingTime} dk okuma</span>
      <span>Â·</span>
      <span>{sources.length} kaynak</span>
    </div>
  </a>
</article>

<style>
  .article-card {
    padding: 1.25rem;
    background: var(--color-bg);
    border: 1px solid var(--color-border);
    border-radius: 12px;
    transition: all 0.2s;
  }

  .article-card:hover {
    border-color: var(--color-primary);
    box-shadow: 0 4px 12px rgba(0,0,0,0.06);
  }

  .article-card a {
    color: var(--color-text);
    text-decoration: none;
    display: block;
  }

  .card-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 0.5rem;
  }

  .category {
    display: inline-block;
    font-size: 0.75rem;
    font-weight: 600;
    padding: 0.2rem 0.6rem;
    border-radius: 20px;
    background: var(--color-primary);
    color: white;
  }

  .archive-badge {
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
    padding: 0.2rem 0.5rem;
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    border-radius: 4px;
    font-size: 0.7rem;
    color: var(--color-text-secondary);
  }

  h3 {
    font-size: 1.1rem;
    margin: 0 0 0.5rem;
    line-height: 1.4;
    transition: color 0.2s;
  }

  .article-card:hover h3 {
    color: var(--color-primary);
  }

  .summary {
    color: var(--color-text-secondary);
    font-size: 0.9rem;
    margin: 0 0 0.75rem;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .meta {
    font-size: 0.8rem;
    color: var(--color-text-secondary);
    display: flex;
    flex-wrap: wrap;
    gap: 0.4rem;
  }
</style>
